<script>
	const tomorrow = new Date(Date.now() + 86400000);
	const oneWayFlight = "one-way";
	const returnFlight = "return";

	let start = [
		tomorrow.getFullYear(),
		pad(tomorrow.getMonth() + 1, 2),
		pad(tomorrow.getDate(), 2)
	].join("-");

	let end = start;
	let tripType = oneWayFlight;

	$: startDate = convertToDate(start);
	$: endDate = convertToDate(end);

	function bookFlight() {
		const type = tripType == returnFlight ? "return" : "one-way";

		let message = `You have booked a ${type} flight, leaving ${startDate.toDateString()}`;
		if (type === "return") {
			message += ` and returning ${endDate.toDateString()}`;
		}

		alert(message);
	}

	function convertToDate(str) {
		const split = str.split("-");
		return new Date(+split[0], +split[1] - 1, +split[2]);
	}

	function pad(x, len) {
		x = String(x);
		while (x.length < len) x = `0${x}`;
		return x;
	}
</script>

<!-- https://github.com/eugenkiss/7guis/wiki#flight-booker -->
<div class="form-group">
	<label class="form-label" for="trip-type">Trip type</label
	><select id="trip-type" class="form-select" bind:value="{tripType}">
		<option value="{oneWayFlight}">one-way flight</option>
		<option value="{returnFlight}">return flight</option>
	</select>
</div>

<div class="form-group">
	<label class="form-label" for="departing-date">Departing</label
	><input
		id="departing-date"
		class="form-input"
		type="date"
		bind:value="{start}"
	/>
</div>

<div class="form-group">
	<label class="form-label" for="returning-date">Returning</label
	><input
		id="returning-date"
		class="form-input"
		type="date"
		bind:value="{end}"
		disabled="{tripType == oneWayFlight}"
	/>
</div>

<div class="form-group">
	<button
		class="btn btn-primary"
		on:click="{bookFlight}"
		disabled="{tripType == returnFlight && (endDate < startDate)}"
	>
		book
	</button>
</div>
